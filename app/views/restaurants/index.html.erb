<% title "Funabiki Online - 飲食店" %>

<div class="container-flex ml-5 mr-5">
	<div class="row align-middle">
		<div class="col">
	<% if current_user.admin?%>
		<div class="btn-group float-right" role="group" aria-label="Basic">
			<%= link_to '追加', new_restaurant_path, :class => "btn btn-success" %>
		</div>
	<% end %> 
		<hr/>

		<h1>飲食店</h1>
		
		</div>
	</div>
	
	<hr/>

	<p id="notice"><%= notice %></p>

	<div class="row h5 p-2 m-1">
		<div class="col">
			本社
			<% company = nil %>
		</div>
		<div class="col">
			飲食店名
		</div>
		<div class="col">
			商品名⇒関連商品
		</div>
		<div class="col">
			操作パネル
		</div>
	</div>
	<% @restaurants.each do |restaurant| %>
		<div class="row <%= ((company.nil?) || (company != restaurant.company)) ? 'border-top pt-1' : () %>">
			<div class="col pb-1">
				<% if (company.nil?) || (company != restaurant.company) %>
					<% company = restaurant.company %>
					<b><%= company %></b>
				<% end %>
			</div>
			<div class="col pb-1">
				<%= link_to(restaurant.namae, restaurant.get_link) %>
			</div>
			<div class="col pb-1">
				<% if restaurant.products %>
					<% restaurant.products.each do |type, type_hash| %>
						<% type_hash.each do |product_name, local_id| %>
							<%= local_id != 0 ? link_to(product_name, Product.find(local_id)) : product_name %><br>
						<% end %>
					<% end %>
				<% end %>
			</div>
			<div class="col pb-1">
				buttons
			</div>
		</div>
	<% end %>

</div>